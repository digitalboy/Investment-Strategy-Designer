### **项目：ETF 投资策略设计与回测工具**

#### **史诗 (Epic) 1: 策略回测准备**

_(这个史诗涵盖了运行一次完整回测前的所有准备工作)_

**用户故事 1.1: 获取 ETF 数据**

- **作为** 一名投资者 (Alex)，
- **我想要** 输入一个 ETF 的代码（如 SPY）和一个时间范围，
- **以便** 工具能够为我的策略回测准备好所需的历史价格数据。

  **验收标准 (Acceptance Criteria):**

  1.  界面上有一个输入框用于填写 ETF 代码。
  2.  界面上有两个日期选择器用于设定回测的开始和结束日期。
  3.  点击“加载数据”按钮后，系统能从后端数据源获取对应的日线数据 (OHLCV)。
  4.  数据加载成功后，界面上显示“数据加载成功”的提示。
  5.  如果输入的代码无效或该时段无数据，系统会显示明确的错误信息。

**用户故事 1.2: 设定初始资金**

- **作为** 一名投资者 (Alex)，
- **我想要** 为我的回测设定一个初始本金，
- **以便** 所有的模拟交易和最终收益计算都有一个明确的起点。

  **验收标准 (Acceptance Criteria):**

  1.  在策略设计区域，有一个标记为“初始本金”的数字输入框。
  2.  该输入框只接受正数。
  3.  设定的初始本金将被回测引擎用作起始现金余额。

---

#### **史诗 (Epic) 2: 构建核心价格策略**

_(这个史诗专注于用户与策略设计器的交互，创建基于价格的规则)_

**用户故事 2.1: 创建“逢低买入”触发器**

- **作为** 一名投资者 (Alex)，
- **我想要** 创建一个基于“价格从高点回撤”的买入触发器，
- **以便** 我能自动化执行我的“打折就买”的核心投资逻辑。

  **验收标准 (Acceptance Criteria):**

  1.  在触发器构建器中，我可以选择“价格从高点回撤”作为条件。
  2.  我可以设定一个回撤百分比 (例如: `15%`)。
  3.  我可以设定一个计算高点的时间窗口 (例如: `60个交易日`)。
  4.  我可以设定触发后的动作为“买入”，并指定买入的金额 (例如: 固定金额`1000元` 或 可用现金的`10%`)。
  5.  添加后，这条规则会以易于理解的语言（例如：“如果价格从 60 日高点下跌超过 15%，则买入 1000 元”）出现在规则列表中。

**用户故事 2.2: 创建“逢高卖出”触发器**

- **作为** 一名投资者 (Alex)，
- **我想要** 创建一个基于“价格创下新高”的卖出触发器，
- **以便** 我能在市场情绪高涨时自动锁定部分利润。

  **验收标准 (Acceptance Criteria):**

  1.  在触发器构建器中，我可以选择“价格创下新高”作为条件。
  2.  我可以设定一个计算新高的时间窗口 (例如: `250个交易日`)。
  3.  我可以设定触发后的动作为“卖出”，并指定卖出的仓位比例 (例如: `现有持仓的10%`)。
  4.  添加后，这条规则会出现在规则列表中。

**用户故事 2.3: 管理已创建的触发器**

- **作为** 一名投资者 (Alex)，
- **我想要** 能够清晰地看到我已添加的所有规则，并且可以删除它们，
- **以便** 我能方便地调整和优化我的整体策略。

  **验收标准 (Acceptance Criteria):**

  1.  界面上有一个专门的区域，用列表形式展示所有已添加的触发器。
  2.  每个触发器旁边都有一个“删除”按钮。
  3.  点击“删除”按钮后，对应的规则会从列表中移除，并且在后续的回测中不再生效。

**用户故事 2.4: 设置触发器冷却期**

- **作为** 一名投资者 (Alex)，
- **我想要** 为我创建的触发器设置一个“冷却期”，
- **以便** 避免在市场信号持续满足的短期内过于频繁地进行交易。

  **验收标准 (Acceptance Criteria):**

  1.  在触发器构建器中，有一个可选的“冷却期”设置项。
  2.  我可以输入一个数字和选择一个时间单位（例如: `5个交易日`）。
  3.  当一个设置了冷却期的触发器被执行后，它在指定的冷却期内将不会再次被触发，即使条件依然满足。

---

#### **史诗 (Epic) 3: 结果分析与可视化**

**用户故事 3.1: 净值与价格叠加分析**

- **作为** 一名量化投资者，
- **我想要** 在回测结果图中，将“策略净值曲线”与“ETF 实际价格走势”叠加显示（双坐标轴），
- **以便** 我能直观地看到策略是在市场上涨时抓住了机会，还是在市场下跌时成功避险。

**用户故事 3.2: 交易信号可视化**

- **作为** 一名策略设计者，
- **我想要** 在图表上看到具体的“买入”和“卖出”标记点，
- **以便** 我能复盘每一次交易是否符合我的预期逻辑（例如：是否真的在低点买入了）。

---

#### **史诗 (Epic) 4: 策略管理与社区 (Strategy Management & Community)**

**用户故事 4.1: 保存策略配置**

- **作为** 一名用户，
- **我想要** 将当前配置好的 ETF、参数和所有触发器保存到云端，并为其命名，
- **以便** 我不会丢失复杂的配置，且可以在不同设备上访问。

**用户故事 4.2: 公开分享策略**

- **作为** 一名用户，
- **我想要** 在保存策略时选择将其设为“公开”，
- **以便** 我可以与社区分享我的投资思路，并获得他人的反馈。

**用户故事 4.3: 浏览策略排行榜**

- **作为** 一名用户（无论是否登录）,
- **我想要** 浏览按回报率或夏普比率排序的公开策略列表,
- **以便** 我能发现市场上表现最好的策略，并从中学习。

**用户故事 4.4: 评论与互动**

- **作为** 一名登录用户,
- **我想要** 在公开策略下方发表评论，或回复他人的评论,
- **以便** 我能与其他投资者交流心得，探讨策略的优缺点。

**用户故事 4.5: 克隆 (Fork) 策略**

- **作为** 一名登录用户,
- **我想要** 将他人的公开策略一键复制到我的个人库中,
- **以便** 我可以在其基础上进行修改和优化，而无需从头开始构建。

这些用户故事共同构成了一个可执行的、有价值的最小可行产品 (MVP) 的开发待办列表 (Product Backlog)。开发团队可以从“史诗 1”开始，逐个故事进行开发、测试和交付。
